<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Animal Image Caption Generator</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <!-- Animated background wrapper -->
  <div class="background-wrapper">
    <main class="container" id="app" data-theme="dark" aria-live="polite">
      <header>
        <div class="logo" aria-hidden="true"><i class="fa-solid fa-paw"></i></div>
        <div>
          <h1>Animal Image Caption Generator</h1>
          <p class="lead">Upload an animal image, get an AI-generated caption.</p>
        </div>
        <div style="margin-left:auto; display:flex; gap:10px; align-items:center;">
          <button id="themeToggle" class="btn secondary" aria-pressed="false" title="Toggle dark / light mode">
            <i id="themeIcon" class="fa-solid fa-sun"></i>
            <span style="font-weight:600;">Theme</span>
          </button>
        </div>
      </header>

      <section class="card" aria-labelledby="uploadHeading">
        <h2 id="uploadHeading" style="font-size:15px; margin:0;">Image Upload</h2>
        <p class="small-muted" style="margin-top:4px;">Drag & drop an image or click to choose. Supported: JPG, PNG. Max recommended size: 8MB.</p>

        <div id="dropzone" class="dropzone" tabindex="0" role="button" aria-label="Upload or drop image here">
          <div class="dz-content" id="dzContent" aria-hidden="false">
            <i class="fa-solid fa-cloud-arrow-up" style="font-size:28px; display:block; margin-bottom:10px;"></i>
            <div style="font-weight:600;">Drop image here or click to upload</div>
            <div style="font-size:13px; color:var(--muted); margin-top:6px;">Preview will appear once selected</div>
          </div>
          <div class="preview" id="previewArea" aria-hidden="true"></div>
          <input id="fileInput" type="file" name="image" accept="image/*" aria-label="Choose an image file" />
        </div>

        <div class="meta" style="margin-top:12px;">
          <div style="display:flex; flex-direction:column; gap:6px;">
            <div class="small-muted">Selected file: <span id="fileName">None</span></div>
          </div>
          <div style="display:flex; gap:8px;">
            <button id="clearBtn" class="btn secondary" title="Clear selection" aria-label="Clear selected image">
              <i class="fa-solid fa-trash"></i> Clear
            </button>
            <button id="generateBtn" class="btn" title="Generate caption" aria-label="Generate caption" disabled>
              <i class="fa-solid fa-magic"></i> Generate Caption
            </button>
          </div>
        </div>

        <div id="leftOverlay" class="overlay" aria-hidden="true">
          <div style="text-align:center;">
            <div class="spinner" role="status" aria-live="polite" aria-label="Generating caption"></div>
            <div class="status" id="leftStatus">Generating caption…</div>
          </div>
        </div>
      </section>

      <section class="controls" aria-labelledby="controlsHeading">
        <div class="card" style="padding:18px;">
          <h3 id="controlsHeading" style="margin:0;">Caption</h3>
          <p class="small-muted" style="margin-top:4px;">Your generated caption will appear below. You can translate, speak, copy, or share it.</p>

          <div class="caption-box" style="margin-top:8px;">
            <div id="captionText" class="caption-text" role="region" aria-live="polite" aria-atomic="true">No caption yet. Upload an image and click Generate Caption.</div>

            <div style="display:flex; justify-content:space-between; align-items:center;">
              <div class="tools" role="toolbar" aria-label="Caption tools">
                <button id="copyBtn" class="chip" title="Copy caption to clipboard" aria-label="Copy caption">
                  <i class="fa-regular fa-copy"></i> Copy
                </button>
                <button id="shareBtn" class="chip" title="Share caption" aria-label="Share caption">
                  <i class="fa-solid fa-share-nodes"></i> Share
                </button>
                <button id="speakBtn" class="chip" title="Speak caption aloud" aria-label="Speak caption">
                  <i class="fa-solid fa-volume-high"></i> Speak
                </button>
              </div>

              <div style="display:flex; gap:8px; align-items:center;">
                <div class="voice-block">
                  <div class="voice-label">Voice Speed</div>
                  <div class="voice-control">
                    <input id="rateSlider" type="range" min="0.5" max="2" step="0.1" value="1">
                    <span id="rateValue">1.0×</span>
                  </div>
                </div>
              </div>
            </div>

            <hr style="border:none; height:1px; background:var(--glass-border); margin:14px 0;">

            <div aria-label="Translation controls">
              <label for="langSelect" class="small">Translate caption to:</label>
              <div style="display:flex; gap:10px; align-items:center; margin-top:6px;">
                <select id="langSelect" aria-label="Select language to translate">
                  <option value="en">English</option>
                  <option value="hi">Hindi</option>
                  <option value="fr">French</option>
                  <option value="es">Spanish</option>
                  <option value="de">German</option>
                </select>
                <button id="translateBtn" class="btn secondary" title="Translate caption" aria-label="Translate caption">
                  <i class="fa-solid fa-language"></i> Translate
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div id="globalOverlay" class="overlay" aria-hidden="true" style="grid-column:1/-1; border-radius:var(--radius);">
        <div style="text-align:center;">
          <div class="spinner" role="status" aria-live="polite" aria-label="Processing"></div>
          <div class="status" id="globalStatus">Processing…</div>
        </div>
      </div>
    </main>
  </div>

  <script src="{{ url_for('static', filename='app.js') }}" defer></script>
</body>
</html>
